# DeepCo_Dual 로드맵

> 듀얼 칩 로봇 제어 시스템 (ESP32-S3 + RTL8720DN)
> 이 문서는 프로젝트의 버전별 작업 현황과 개선 계획을 관리합니다.

---

## v0.1.0 (현재) — 초기 듀얼 칩 구현

### 완료 항목
- [x] ESP32-S3 / RTL8720DN 역할 분리 설계 및 구현
- [x] UART 제어 명령 브릿지 (RTL → S3)
- [x] SPI 카메라 JPEG 스트리밍 (S3 → RTL)
- [x] RTL8720DN Wi-Fi SoftAP (5GHz, ch36)
- [x] WebSocket 제어 서버 (`ws://192.168.4.1/ws`, port 80)
- [x] WebSocket 카메라 서버 (`ws://192.168.4.1:81/`, port 81)
- [x] DeepCoConnector 호환 유지 (기존 v1.3 프로토콜)
- [x] FreeRTOS 멀티태스크 아키텍처 (SPI/제어/LED 분리)
- [x] SPI 프로토콜 설계 (`DCM2` 매직, 시퀀스, START/END 플래그)
- [x] LED 상태 머신 (BOOTING → READY → WIFI_CONNECTED → CONNECTED)
- [x] RTL → S3 연결 상태 전달 (`@ws`, `@sta` 명령)
- [x] WS 연결 해제 시 자동 정지 (안전 메커니즘)
- [x] 빌드 가이드 문서 (`README_Arduino_빌드방법.md`)
- [x] 개발 전략 문서 (`dual_chip개발 전략.md`)

---

## v0.1.1 (예정) — 설정 분리 및 유연성 개선

- [ ] 핀 번호/보드레이트/버퍼 크기를 설정 헤더(`config.h`)로 분리
  - 현재: 코드 내 하드코딩 → 보드 변경 시 여러 곳 수정 필요
  - 목표: 한 곳만 수정하면 전체 반영
- [ ] Wi-Fi 채널/비밀번호를 런타임 또는 시리얼 명령으로 변경 가능하게
  - 현재: 코드에 고정 (`ch36`, 비밀번호 하드코딩)
  - 목표: 현장에서 재플래시 없이 채널 변경 가능

---

## v0.1.2 (예정) — 통신 안정성 강화

- [ ] SPI 동기화 손실 시 복구 로직 강화
  - 현재: 프레임 깨짐 시 대응이 약함
  - 목표: 타임아웃 기반 자동 리셋/재동기화
- [ ] 카메라 프레임 버퍼 크기 확대 또는 동적 할당
  - 현재: RTL 측 64KB 고정 → 고해상도 JPEG에 부족할 수 있음
- [ ] 에러 상태 전파 시스템 구축
  - 현재: S3 카메라 초기화 실패 등이 PC까지 전달되지 않음
  - 목표: S3 에러 → RTL → WS → DeepCoConnector까지 에러 코드 전파

---

## v0.1.3 (예정) — 디버깅 및 진단 개선

- [ ] USB Serial 디버그 레벨 토글 기능 추가
  - 현재: `ENABLE_USB_SERIAL_DEBUG = false` 고정
  - 목표: 런타임 명령으로 디버그 ON/OFF 전환
- [ ] 진단 정보 리포팅 강화
  - FPS, 프레임 드랍 수, SPI 에러 수, 연결 시간 등
  - WS를 통해 DeepCoConnector에 진단 데이터 전달

---

## Backlog (미배정 — 필요 시 버전에 할당)

- [ ] OTA(무선) 펌웨어 업데이트 지원
  - RTL이 Wi-Fi AP를 가지고 있으므로 OTA 구현 가능
- [ ] PlatformIO 또는 Arduino CLI 빌드 자동화
  - 현재: Arduino IDE 수동 빌드만 지원
  - 목표: 커맨드 라인 빌드로 CI/CD 연동 가능
- [ ] SPI 단일 링크로 제어+카메라 멀티플렉싱 통합
  - 현재: UART(제어) + SPI(카메라) 2링크
  - 목표: SPI 하나로 통합하여 배선 단순화
- [ ] 프레임 CRC32 체크 활성화
  - `dual_chip개발 전략.md`에 설계는 있으나 구현 보류 중

---

## 변경 이력

| 버전 | 날짜 | 요약 |
|------|------|------|
| v0.1.0 | 2026-02-09 | 초기 듀얼 칩 구현 완료, GitHub 등록 |
